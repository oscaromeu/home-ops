apiVersion: kustomize.config.k8s.io/v1beta1
kind: Kustomization
namespace: grafana

resources:
  - ./secret.sops.yaml
  - ./service-extra.yaml
  - ./configmap.yaml
  - ../base

configMapGenerator:
  - name: tempo-config
    behavior: merge
    files:
      - tempo.yaml=values.yaml

patches:
- target:
    group: helm.toolkit.fluxcd.io
    kind: HelmRelease
    name: grafana
  path: helm-patch.yaml

generatorOptions:
  disableNameSuffixHash: true
  annotations:
    app.kubernetes.io/managed-by: "helm"
    meta.helm.sh/release-name: "tempo"
    meta.helm.sh/release-namespace: "observability"